<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Project Design - Python Development Environment</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="purpose.html"><strong aria-hidden="true">1.</strong> Purpose </a></li><li class="chapter-item expanded "><a href="project_design.html" class="active"><strong aria-hidden="true">2.</strong> Project Design</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Python Development Environment</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="project-design"><a class="header" href="#project-design">Project Design</a></h1>
<p>We have a few resources at our disposal for our project. The first link is a tutorial on how to integrate Cython, Sphinx and Poetry all together. This will be a great starting point for us to get our project off the ground. The second link is how to create a Poetry environment within Docker and manage dependencies. This will be a great way to ensure our environment is configured properly and that everything runs smoothly. With these two links, we should have all we need to get our project up and running.</p>
<p>Sources: </p>
<ul>
<li><a href="https://stackoverflow.com/questions/57988721/poetry-sphinx-cython">Using Cython + Poetry + Sphinx</a></li>
<li><a href="https://stackoverflow.com/questions/53835198/integrating-python-poetry-with-docker">Integrating Python Poetry with Docker</a></li>
<li><a href="https://hub.docker.com/r/sphinxdoc/sphinx">Docker Sphinx Image</a></li>
<li><a href="https://docs.docker.com/language/java/run-tests/#multi-stage-dockerfile-for-testing">Multi-stage Dockerfile for testing</a></li>
</ul>
<h2 id="project-specifications"><a class="header" href="#project-specifications">Project Specifications:</a></h2>
<p>The main objectives are to create a design for incorporating Poetry within a Docker environment.</p>
<ul>
<li>Maintain separate directories for PyTest test files (<code>tests/</code>) and Sphinx documentation (<code>docs/</code>) on the host machine during development.</li>
<li>Avoid directly including the test files and documentation in the Docker image.</li>
<li>Utilize Poetry to manage dependencies within the Docker environment.</li>
<li>Ensure that the Docker image is configured to access the test files and documentation directories from the host machine.</li>
<li>Have the Sphinx output <code>index.html</code> auto-build when there are changes to the code and have it only be visible on the host machine.</li>
<li>The PyTest test files (<code>tests/</code>)  could be executed within the Docker image with Cython and Python files alike.</li>
</ul>
<p><strong>Context:</strong></p>
<p>Given that Docker is being employed for my development environment and Poetry for managing dependencies, it is our objective to establish a streamlined workflow whereby the PyTest test files and Sphinx documentation directories are retained on the host machine while only code and its associated dependencies reside within the Docker image. This strategy facilitates seamless testing execution in a Docker setting whilst also guaranteeing updated documentation generation by Sphinx.</p>
<p><strong>Directory Structure:</strong></p>
<pre><code>Host Machine:
├── project/
|   ├── poetry.lock
|   ├── pyproject.toml
│   ├── code/
│   │   ├── file1.py
│   │   ├── file2.py
|   |   ├── cythonfile.pyx
│   │   └── ...
│   ├── tests/
│   │   ├── test_file1.py
│   │   ├── test_file2.py
│   │   └── ...
│   └── docs/
│       ├── conf.py
│       ├── index.rst
│       ├── index.html (Output)
│       └── ...
└── Dockerfile

Docker Machine:
└── app/
    ├── poetry.lock
    ├── pyproject.toml
    ├── file1.py
    ├── file2.py
    ├── cythonfile.pyx
    └── test/
        ├── test_file1.py
        ├── test_file2.py
        └── ...
</code></pre>
<h2 id="design-structure"><a class="header" href="#design-structure">Design Structure</a></h2>
<p>This setup ensures compatibility and consistency by pinning versions and files. It uses Docker to isolate dependencies, supports Cython with GCC compiler, auto-builds Sphinx documentation, and enables interactive Pytest testing while optionally removing containers upon exit. <code>base</code> Image consists of setting up <code>Poetry</code>, <code>Cython</code> , and <code>Sphinx</code>. The <code>test</code> image contains the <code>base</code> image with the <code>pytest</code> testing capabilities </p>
<ul>
<li><strong>Setting up <code>Poetry</code>:</strong>
To ensure compatibility and consistency, pin the Poetry version and <code>pyproject.toml</code> file. Add <code>/src</code> to the Python path and copy <code>poetry.lock</code> and <code>pyproject.toml</code> files for dependency management. Enable virtual environments for isolating dependencies within Docker. Separate development and production dependencies using build process arguments for precise installation.
<ul>
<li>Pin the version of Poetry to ensure compatibility and prevent build issues.</li>
<li>Pin the version of the <code>pyproject.toml</code> file to maintain consistency.
<ul>
<li>Add  <code>/src</code> directory to the Python path</li>
</ul>
</li>
<li>Copy the <code>poetry.lock</code> and <code>pyproject.toml</code> files into the Docker image for dependency management.</li>
<li>Enable virtual environments to isolate dependencies within the Docker environment.</li>
<li>Separate dependencies for development and production environments by passing arguments during the build process to install the required sets of dependencies.</li>
</ul>
</li>
<li><strong>Setting up <code>Cython</code>:</strong>
<ul>
<li>Install the GCC compiler from the Dockerfile</li>
<li>pip install <code>Cython</code>(from <code>poetry.lock</code> or <code>pyproject.toml</code>)</li>
</ul>
</li>
<li><strong>Setting up <code>Sphinx</code> to auto-build documentation:</strong>
Utilize the official Sphinx Docker image to generate HTML documentation automatically by running <code>docker run --rm -v /path/to/document:/docs sphinxdoc/sphinx make html</code>. The command binds the local <code>/path/to/document</code> to the <code>/docs</code> directory in the container, producing output in <code>/path/to/document/_build/html</code>.
<ul>
<li>Create sphinx documents in docker: <a href="https://hub.docker.com/r/sphinxdoc/sphinx">Sphinx-Docker</a>
<ul>
<li>We could create a bash command when the user runs sphinx make html it could execute the command: <code>docker run --rm -v /path/to/document:/docs sphinxdoc/sphinx make html</code>
<ul>
<li><code>docker run</code>: Run a Docker container.</li>
<li><code>-rm</code>: Automatically remove the container after it exits.</li>
<li><code>v /path/to/document:/docs</code>: Bind mount the local directory <code>/path/to/document</code> into the container at <code>/docs</code>.</li>
<li><code>sphinxdoc/sphinx</code>: Use the official Sphinx Docker image.</li>
<li><code>make html</code>: Generate HTML documentation using Sphinx, output placed in <code>/path/to/document/_build/html</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>Setting up <code>Pytest</code>:</strong>
This Dockerfile employs a multi-stage setup to configure <code>Pytest</code> interactively by adding <strong><code>/tests</code></strong> to the Python path. It facilitates running tests in detached mode, enabling additional test execution, and optionally, ensures automatic removal of the Docker container upon exit using <code>--rm</code>.
<ul>
<li>Inherits from the <strong><code>base</code></strong> stage.</li>
<li>Sets an environment variable <strong><code>PYTHONPATH</code></strong> to include <strong><code>/tests</code></strong> on the Python path.</li>
<li>Copies the entire application source code (including tests) to the <strong><code>/app</code></strong> directory.</li>
<li>Use a <code>CMD</code> command for <code>bash -c</code> to run pytest in interactive mode and (<strong><code>tail -f /dev/null</code></strong>) to keep the container running in detached mode.</li>
<li><strong>Optional:</strong> have the Docker Container be immediately removed after exiting with the use of <code>--rm</code> during the run stage.</li>
</ul>
</li>
</ul>
<p><strong>Requirements:</strong> <code>Cython(.pyx)</code> and <code>Python(.py)</code> files should be compatible.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="purpose.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="purpose.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
